
#
# $Id$
#
# Simple rules to make the unicode.c tables
#
#

UDATA=	UnicodeData.txt
CDATA=  SpecialCasing.txt
srcdir=	.

all:	unicode.inc unicase.inc

unicode.inc: gen genZscodes copyright ${UDATA}
	( cat ${srcdir}/copyright; \
	  echo ; \
	  echo "/* generated by gen on `date` */"; \
	 ./gen ${srcdir}/${UDATA} 11 Cf Cf; \
	 ./gen ${srcdir}/${UDATA} 14 Zs Zs; \
	 ./gen ${srcdir}/${UDATA} 11 IS '$$_' Lu Ll Lt Lm Lo Nl; \
	 ./gen ${srcdir}/${UDATA} 11 IP '$$_' Lu Ll Lt Lm Lo Nl Mn Mc Nd Pc; \
	 ${SHELL} ${srcdir}/genZscodes ${srcdir}/${UDATA}; \
	 ) > $@
	cp $@ ${srcdir}/../libsee/unicode.inc

unicase.inc: gencase.pl ${UDATA} ${CDATA}
	( cat ${srcdir}/copyright; \
	  perl gencase.pl \
	) > $@
	cp $@ ${srcdir}/../libsee/unicase.inc

#
# I used this rule to analyze the best factoring ratio for the tables.
# The best values have since been hard coded.
#
analyse: gen
	 ./gen ${srcdir} - Cf
	 ./gen ${srcdir} - Zs
	 ./gen ${srcdir} - '$$_' Lu Ll Lt Lm Lo Nl
	 ./gen ${srcdir} - '$$_' Lu Ll Lt Lm Lo Nl Mn Mc Nd Pc

#
# Get the latest unicode tables
#
$(UDATA):
	wget http://www.unicode.org/Public/UNIDATA/$(UDATA)
$(CDATA):
	wget http://www.unicode.org/Public/UNIDATA/$(CDATA)

clean:
	rm -f unicode.inc gen
	#rm -f UnicodeData.txt SpecialCasing.txt
